
import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';

class LanguageProvider extends ChangeNotifier {
  Locale _locale = const Locale('en');

  LanguageProvider() {
    _loadLanguage();
  }

  Locale get locale => _locale;

  final List<Map<String, String>> supportedLanguages = [
    {'code': 'en', 'name': 'English', 'flag': 'üá∫üá∏'},
    {'code': 'hi', 'name': '‡§π‡§ø‡§Ç‡§¶‡•Ä (Hindi)', 'flag': 'üáÆüá≥'},
    {'code': 'es', 'name': 'Espa√±ol (Spanish)', 'flag': 'üá™üá∏'},
    {'code': 'fr', 'name': 'Fran√ßais (French)', 'flag': 'üá´üá∑'},
    {'code': 'de', 'name': 'Deutsch (German)', 'flag': 'üá©üá™'},
  ];

  String getText(String key) {
    // Fallback to English if key or translation is missing
    return _localizedValues[_locale.languageCode]?[key] ?? _localizedValues['en']?[key] ?? key;
  }

  void changeLanguage(String languageCode) async {
    _locale = Locale(languageCode);
    SharedPreferences prefs = await SharedPreferences.getInstance();
    await prefs.setString('language_code', languageCode);
    notifyListeners();
  }

  void _loadLanguage() async {
    SharedPreferences prefs = await SharedPreferences.getInstance();
    String? lang = prefs.getString('language_code');
    if (lang != null) {
      _locale = Locale(lang);
      notifyListeners();
    }
  }

  // --- THE DICTIONARY ---
  final Map<String, Map<String, String>> _localizedValues = {
    'en': {
      // General
      'app_name': 'EvesDrops',
      'close': 'Close',
      'loading': 'Loading...',
      'copy_code': 'Room code copied!',
      'error': 'Error',
      
      // Home & Settings
      'home': 'Home',
      'games': 'Games',
      'learn': 'Learn',
      'settings': 'Settings',
      'dark_mode': 'Dark Mode',
      'light_mode': 'Light Mode',
      'kinks': 'Kinks',
      'feedback': 'Feedback',
      'data_privacy': 'Data & Privacy',
      'languages': 'Languages',
      'report': 'Report Issue',
      'logout': 'Logout',
      'delete_account': 'Delete Account',
      'exit': 'Exit',
      'cancel': 'Cancel',
      'proceed': 'Proceed',

      // Learn Page
      'wellness_intimacy': 'Wellness & Intimacy',
      'read_guide': 'Read Guide',
      'sections_count': 'Sections',
      'takeaway': 'Takeaway',
      
      // Maze Game
      'maze': 'Intimacy Maze',
      'play_with_partner': 'Play with your partner',
      'play_offline': 'Play Offline (Local)',
      'or_online': '- OR ONLINE -',
      'create_online': 'Create Online Room',
      'enter_code': 'Enter 6-digit Room Code',
      'join_room': 'Join Room',
      'room': 'Room',
      'waiting_partner': 'Waiting for partner...',
      'your_turn': 'YOUR TURN',
      'partner_turn': 'PARTNER\'S TURN',
      'trap_msg': '‚ö†Ô∏è TRAP! Moved back 3 spaces!',
      'bonus_msg': 'üåü BONUS CELL! +20 Points!',
      'collision_msg': 'üíû COLLISION! Love Bonus!',
      
      // Truth or Dare
      'truth_dare': 'Truth or Dare',
      'tap_reveal': 'Tap to Reveal',
      'truth': 'Truth',
      'dare': 'Dare',

      // 4 Cards
      '4_cards': '4 Cards',
      'task_prompt': 'Here is a task. Complete this challenge!',

      // Keyword Obsession (Categories)
      'keyword': 'Keyword Obsession',
      'Bondage': 'Bondage',
      'Toys': 'Toys',
      'Dominance/Submission': 'Dominance/Submission',
      'Oral': 'Oral',
      'Spanking': 'Spanking',
      'Food': 'Food',
      'Teasing/Denial': 'Teasing/Denial',
      'Anal': 'Anal',
      'Massage': 'Massage',
      'Kiss': 'Kiss',
      'Feet': 'Feet',
      'Music': 'Music',
      'Tantra': 'Tantra',
      'Roleplay': 'Roleplay',
      'Sensory Deprivation': 'Sensory Deprivation',
      'Alcohol': 'Alcohol',
      'Photo/Video': 'Photo/Video',
      'Porn': 'Porn',
      'Lipstick': 'Lipstick',
      'Penetration': 'Penetration',
      'Masturbation': 'Masturbation',
      'Lingerie': 'Lingerie',
      'Body Writing': 'Body Writing',
      'Breath Play': 'Breath Play',
      'Hair Play': 'Hair Play',
      'Scent Play': 'Scent Play',
      'Fantasy Sharing': 'Fantasy Sharing',
      'Tickling': 'Tickling',
      'Storytelling': 'Storytelling',
      'Striptease': 'Striptease',
      'Gamer': 'Gamer',
      'Nature': 'Nature',
      'Voyeurism': 'Voyeurism',
      'Exhibitionism': 'Exhibitionism',
      'Choking': 'Choking',
      'Light bondage': 'Light bondage',
      'next_task': 'Next Task',
      'no_more_tasks': 'No more tasks available!',
    },
    'hi': {
      'app_name': 'EvesDrops',
      'close': '‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç',
      'loading': '‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',
      'copy_code': '‡§∞‡•Ç‡§Æ ‡§ï‡•ã‡§° ‡§ï‡•â‡§™‡•Ä ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!',
      'error': '‡§§‡•ç‡§∞‡•Å‡§ü‡§ø',
      'home': '‡§π‡•ã‡§Æ',
      'games': '‡§ñ‡•á‡§≤',
      'learn': '‡§∏‡•Ä‡§ñ‡•á‡§Ç',
      'settings': '‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏',
      'dark_mode': '‡§°‡§æ‡§∞‡•ç‡§ï ‡§Æ‡•ã‡§°',
      'light_mode': '‡§≤‡§æ‡§á‡§ü ‡§Æ‡•ã‡§°',
      'kinks': '‡§™‡§∏‡§Ç‡§¶ (Kinks)',
      'feedback': '‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ',
      'data_privacy': '‡§°‡•á‡§ü‡§æ ‡§î‡§∞ ‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ',
      'languages': '‡§≠‡§æ‡§∑‡§æ‡§è‡§Ç',
      'report': '‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç',
      'logout': '‡§≤‡•â‡§ó ‡§Ü‡§â‡§ü',
      'delete_account': '‡§ñ‡§æ‡§§‡§æ ‡§π‡§ü‡§æ‡§è‡§Ç',
      'exit': '‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡•á‡§Ç',
      'cancel': '‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç',
      'proceed': '‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•á‡§Ç',
      'wellness_intimacy': '‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£ ‡§î‡§∞ ‡§Ü‡§§‡•ç‡§Æ‡•Ä‡§Ø‡§§‡§æ',
      'read_guide': '‡§ó‡§æ‡§á‡§° ‡§™‡§¢‡§º‡•á‡§Ç',
      'sections_count': '‡§≠‡§æ‡§ó',
      'takeaway': '‡§®‡§ø‡§∑‡•ç‡§ï‡§∞‡•ç‡§∑',
      'maze': '‡§á‡§Ç‡§ü‡•Ä‡§Æ‡•á‡§∏‡•Ä ‡§≠‡•Ç‡§≤‡§≠‡•Å‡§≤‡•à‡§Ø‡§æ',
      'play_with_partner': '‡§Ö‡§™‡§®‡•á ‡§∏‡§æ‡§•‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ñ‡•á‡§≤‡•á‡§Ç',
      'play_offline': '‡§ë‡§´‡§º‡§≤‡§æ‡§á‡§® ‡§ñ‡•á‡§≤‡•á‡§Ç (‡§≤‡•ã‡§ï‡§≤)',
      'or_online': '- ‡§Ø‡§æ ‡§ë‡§®‡§≤‡§æ‡§á‡§® -',
      'create_online': '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§∞‡•Ç‡§Æ ‡§¨‡§®‡§æ‡§è‡§Ç',
      'enter_code': '6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',
      'join_room': '‡§∞‡•Ç‡§Æ ‡§ú‡•ç‡§µ‡§æ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç',
      'room': '‡§∞‡•Ç‡§Æ',
      'waiting_partner': '‡§∏‡§æ‡§•‡•Ä ‡§ï‡§æ ‡§á‡§Ç‡§§‡§ú‡§æ‡§∞...',
      'your_turn': '‡§Ü‡§™‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä',
      'partner_turn': '‡§∏‡§æ‡§•‡•Ä ‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä',
      'truth_dare': '‡§∏‡§ö ‡§Ø‡§æ ‡§π‡§ø‡§Æ‡•ç‡§Æ‡§§',
      'tap_reveal': '‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç',
      'truth': '‡§∏‡§ö',
      'dare': '‡§π‡§ø‡§Æ‡•ç‡§Æ‡§§',
      '4_cards': '4 ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏',
      'task_prompt': '‡§Ø‡§π‡§æ‡§Å ‡§è‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à‡•§ ‡§á‡§∏‡•á ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç!',
      'keyword': '‡§ï‡•Ä‡§µ‡§∞‡•ç‡§° ‡§ë‡§¨‡•ç‡§∏‡•á‡§∂‡§®',
      'Bondage': '‡§¨‡§Ç‡§ß‡§®',
      'Toys': '‡§ñ‡§ø‡§≤‡•å‡§®‡•á',
      'Dominance/Submission': '‡§™‡•ç‡§∞‡§≠‡•Å‡§§‡•ç‡§µ/‡§∏‡§Æ‡§∞‡•ç‡§™‡§£',
      'Oral': '‡§Æ‡•å‡§ñ‡§ø‡§ï',
      'Massage': '‡§Æ‡§æ‡§≤‡§ø‡§∂',
      'Kiss': '‡§ö‡•Å‡§Ç‡§¨‡§®',
      'Feet': '‡§™‡•à‡§∞',
      'Music': '‡§∏‡§Ç‡§ó‡•Ä‡§§',
      'Roleplay': '‡§∞‡•ã‡§≤‡§™‡•ç‡§≤‡•á',
      'next_task': '‡§Ö‡§ó‡§≤‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø',
    },
    'es': {
      'app_name': 'EvesDrops',
      'close': 'Cerrar',
      'home': 'Inicio',
      'settings': 'Ajustes',
      'wellness_intimacy': 'Bienestar e Intimidad',
      'read_guide': 'Leer Gu√≠a',
      'sections_count': 'Secciones',
      'takeaway': 'Conclusi√≥n',
      'maze': 'Laberinto √çntimo',
      'play_with_partner': 'Juega con tu pareja',
      'play_offline': 'Jugar Offline (Local)',
      'or_online': '- O EN L√çNEA -',
      'create_online': 'Crear Sala Online',
      'enter_code': 'C√≥digo de 6 d√≠gitos',
      'join_room': 'Unirse a Sala',
      'room': 'Sala',
      'waiting_partner': 'Esperando pareja...',
      'your_turn': 'TU TURNO',
      'partner_turn': 'TURNO DE PAREJA',
      'truth_dare': 'Verdad o Reto',
      'tap_reveal': 'Toca para Revelar',
      'truth': 'Verdad',
      'dare': 'Reto',
      '4_cards': '4 Cartas',
      'task_prompt': 'Aqu√≠ tienes una tarea. ¬°Compl√©tala!',
      'keyword': 'Obsesi√≥n',
      'Bondage': 'Bondage',
      'Toys': 'Juguetes',
      'Dominance/Submission': 'Dominaci√≥n/Sumisi√≥n',
      'Oral': 'Oral',
      'Massage': 'Masaje',
      'Kiss': 'Beso',
      'next_task': 'Siguiente Tarea',
    },
    'fr': {
      'app_name': 'EvesDrops',
      'close': 'Fermer',
      'home': 'Accueil',
      'settings': 'Param√®tres',
      'wellness_intimacy': 'Bien-√™tre et Intimit√©',
      'read_guide': 'Lire le Guide',
      'sections_count': 'Sections',
      'takeaway': '√Ä retenir',
      'maze': 'Labyrinthe',
      'play_with_partner': 'Jouez avec votre partenaire',
      'play_offline': 'Jouer Hors Ligne',
      'or_online': '- OU EN LIGNE -',
      'create_online': 'Cr√©er une Salle',
      'enter_code': 'Code √† 6 chiffres',
      'join_room': 'Rejoindre',
      'room': 'Salle',
      'waiting_partner': 'En attente...',
      'your_turn': '√Ä VOUS',
      'partner_turn': 'TOUR DU PARTENAIRE',
      'truth_dare': 'Action ou V√©rit√©',
      'tap_reveal': 'Appuyez pour R√©v√©ler',
      'truth': 'V√©rit√©',
      'dare': 'Action',
      '4_cards': '4 Cartes',
      'task_prompt': 'Voici une t√¢che. Relevez le d√©fi !',
      'keyword': 'Mots Cl√©s',
      'Bondage': 'Bondage',
      'Toys': 'Jouets',
      'Dominance/Submission': 'Domination/Soumission',
      'Oral': 'Oral',
      'Massage': 'Massage',
      'Kiss': 'Baiser',
      'next_task': 'T√¢che Suivante',
    },
    'de': {
      'app_name': 'EvesDrops',
      'close': 'Schlie√üen',
      'home': 'Startseite',
      'settings': 'Einstellungen',
      'wellness_intimacy': 'Wellness & Intimit√§t',
      'read_guide': 'Anleitung lesen',
      'sections_count': 'Abschnitte',
      'takeaway': 'Fazit',
      'maze': 'Labyrinth',
      'play_with_partner': 'Spiel mit deinem Partner',
      'play_offline': 'Offline spielen',
      'or_online': '- ODER ONLINE -',
      'create_online': 'Online-Raum erstellen',
      'enter_code': '6-stelliger Code',
      'join_room': 'Raum beitreten',
      'room': 'Raum',
      'waiting_partner': 'Warten auf Partner...',
      'your_turn': 'DU BIST DRAN',
      'partner_turn': 'PARTNER IST DRAN',
      'truth_dare': 'Wahrheit/Pflicht',
      'tap_reveal': 'Tippen zum Aufdecken',
      'truth': 'Wahrheit',
      'dare': 'Pflicht',
      '4_cards': '4 Karten',
      'task_prompt': 'Hier ist eine Aufgabe. Erledige sie!',
      'keyword': 'Stichwort',
      'Bondage': 'Fesselspiele',
      'Toys': 'Spielzeug',
      'Dominance/Submission': 'Dominanz/Unterwerfung',
      'Oral': 'Oral',
      'Massage': 'Massage',
      'Kiss': 'Kuss',
      'next_task': 'N√§chste Aufgabe',
    },
  };
}